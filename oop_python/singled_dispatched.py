import html

def htmlize0(obj):
    """ ç”Ÿæˆ HTMLï¼Œæ˜¾ç¤ºä¸åŒç±»å‹çš„ Python å¯¹è±¡ã€‚ """
    """ è¿™ä¸ªå‡½æ•°é€‚ç”¨äºä»»ä½• Python ç±»å‹ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬æƒ³åšä¸ªæ‰©å±•ï¼Œè®©å®ƒä½¿ç”¨ç‰¹åˆ«çš„æ–¹å¼æ˜¾ç¤ºæŸäº›ç±»å‹ã€‚
strï¼šæŠŠå†…éƒ¨çš„æ¢è¡Œç¬¦æ›¿æ¢ä¸º '<br>\n'ï¼›ä¸”ä¸ä½¿ç”¨ <pre>ï¼Œè€Œæ˜¯ä½¿ç”¨ <p>ã€‚
intï¼šä»¥åè¿›åˆ¶å’Œåå…­è¿›åˆ¶æ˜¾ç¤ºæ•°å­—ã€‚
listï¼šè¾“å‡ºä¸€ä¸ª HTML åˆ—è¡¨ï¼Œæ ¹æ®å„ä¸ªå…ƒç´ çš„ç±»å‹è¿›è¡Œæ ¼å¼åŒ–ã€‚ """
    content = html.escape(str(obj))
    # content = html.escape(repr(obj))
    return '<pre>{}</pre>'.format(content)

print(type({1,2,3}))
print(htmlize0({1,2,3}))
print(htmlize0(abs))
## 
from functools import singledispatch
from collections import abc
import numbers
import html
# å®šä¹‰å•åˆ†æ´¾å‡½æ•°:åˆ©ç”¨@singledispatch åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ htmlize.register è£…é¥°å™¨ï¼ŒæŠŠå¤šä¸ªå‡½æ•°ç»‘åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ³›å‡½æ•°
@singledispatch  # @singledispatch æ ‡è®°å¤„ç† object ç±»å‹çš„åŸºå‡½æ•°ã€‚
def htmlize(obj):
    # ç”±äºæœ¬å‡½æ•°è¢«singledispatchæ‰€ä¿®é¥°,å› æ­¤å¯èƒ½åœ¨è°ƒç”¨çš„æ—¶å€™å› é‡åˆ°ä¸åŒç±»å‹çš„å‚æ•°,å‡½æ•°ä½“(å‡½æ•°è¡Œä¸º)è¢«æ›¿æ¢ä¸ºå¯¹åº”çš„ä¸“é—¨å‡½æ•°æ¥å¤„ç†,ä¸‹é¢çš„é€»è¾‘æ˜¯ä¸€ç§å¯èƒ½çš„æ‰§è¡Œæ–¹å¼
    content = html.escape(repr(obj))
    return '<pre>{}</pre>'.format(content)
#å„ä¸ªä¸“é—¨å‡½æ•°ä½¿ç”¨ @<base_function>.register(<type>) è£…é¥°ã€‚
# ä¸“é—¨å‡½æ•°çš„åç§°æ— å…³ç´§è¦ï¼›_ æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œç®€å•æ˜äº†
@htmlize.register(str)  
def _(text):            
    # å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯str(å­—ç¬¦ä¸²å‹),å°è¯•å°†`\n`æ›¿æ¢ä¸º<br>,å¹¶ä¸”æ ‡ç­¾è¦ä»é»˜è®¤çš„<pre>æ”¹ä¸º<p>
    content = html.escape(text).replace('\n', '<br>')
    return '<p>{0}</p>'.format(content)
# ä¸ºæ¯ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»å‹æ³¨å†Œä¸€ä¸ªå‡½æ•°ã€‚numbers.Integral æ˜¯ int çš„è™šæ‹Ÿè¶…ç±»ã€‚
@htmlize.register(numbers.Integral)  
def _(n):
    # return '<pre>{0} (0x{0:x})</pre>'.format(n)
    return '<pre>{0} ({0:#x})</pre>'.format(n)

# å¯ä»¥å æ”¾å¤šä¸ª register è£…é¥°å™¨ï¼Œè®©åŒä¸€ä¸ªå‡½æ•°æ”¯æŒä¸åŒç±»å‹ã€‚
@htmlize.register(tuple)  
@htmlize.register(abc.MutableSequence)
def _(seq):
    inner = '\n\t</li>\n\n\t<li>\n\t\tğŸˆ'.join(''+htmlize(item) for item in seq)
    return '<ul>\n\t<li>' + inner + '\n\t</li>\n</ul>'
# åªè¦å¯èƒ½ï¼Œæ³¨å†Œçš„ä¸“é—¨å‡½æ•°åº”è¯¥å¤„ç†æŠ½è±¡åŸºç±»ï¼ˆå¦‚ numbers.Integralå’Œ abc.MutableSequenceï¼‰ï¼Œä¸è¦å¤„ç†å…·ä½“å®ç°ï¼ˆå¦‚ int å’Œlistï¼‰ã€‚
# è¿™æ ·ï¼Œä»£ç æ”¯æŒçš„å…¼å®¹ç±»å‹æ›´å¹¿æ³›ã€‚ä¾‹å¦‚ï¼ŒPython æ‰©å±•å¯ä»¥å­ç±»åŒ– numbers.Integralï¼Œä½¿ç”¨å›ºå®šçš„ä½æ•°å®ç° int ç±»å‹ã€‚
# ã€€ä½¿ç”¨æŠ½è±¡åŸºç±»æ£€æŸ¥ç±»å‹ï¼Œå¯ä»¥è®©ä»£ç æ”¯æŒè¿™äº›æŠ½è±¡åŸºç±»ç°æœ‰å’Œæœªæ¥çš„å…·ä½“å­ç±»æˆ–è™šæ‹Ÿå­ç±»ã€‚
# singledispatch æœºåˆ¶çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹å¾æ˜¯ï¼Œä½ å¯ä»¥åœ¨ç³»ç»Ÿçš„ä»»ä½•åœ°æ–¹å’Œä»»ä½•æ¨¡å—ä¸­æ³¨å†Œä¸“é—¨å‡½æ•°ã€‚å¦‚æœåæ¥åœ¨æ–°çš„æ¨¡å—ä¸­å®šä¹‰äº†æ–°çš„ç±»å‹ï¼Œå¯ä»¥è½»æ¾åœ°æ·»åŠ ä¸€ä¸ªæ–°çš„ä¸“é—¨å‡½æ•°æ¥å¤„ç†é‚£ä¸ªç±»å‹ã€‚
# æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥ä¸ºä¸æ˜¯è‡ªå·±ç¼–å†™çš„æˆ–è€…ä¸èƒ½ä¿®æ”¹çš„ç±»æ·»åŠ è‡ªå®šä¹‰å‡½æ•°ã€‚
# singledispatch æ˜¯ç»è¿‡æ·±æ€ç†Ÿè™‘ä¹‹åæ‰æ·»åŠ åˆ°æ ‡å‡†åº“ä¸­çš„ï¼Œå®ƒæä¾›çš„ç‰¹æ€§å¾ˆå¤šï¼Œè¿™é‡Œæ— æ³•ä¸€ä¸€è¯´æ˜ã€‚è¿™ä¸ªæœºåˆ¶æœ€å¥½çš„æ–‡æ¡£æ˜¯â€œPEP 443 â€”Single-dispatch generic functionsâ€ï¼ˆhttps://www.python.org/dev/peps/pep-0443/ï¼‰ã€‚
# @singledispatch ä¸æ˜¯ä¸ºäº†æŠŠ Java çš„é‚£ç§æ–¹æ³•é‡è½½å¸¦å…¥Pythonã€‚
# åœ¨ä¸€ä¸ªç±»ä¸­ä¸ºåŒä¸€ä¸ªæ–¹æ³•å®šä¹‰å¤šä¸ªé‡è½½å˜ä½“ï¼Œæ¯”åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ä¸€é•¿ä¸² if/elif/elif/elif å—è¦æ›´å¥½ã€‚
# ä½†æ˜¯è¿™ä¸¤ç§æ–¹æ¡ˆéƒ½æœ‰ç¼ºé™·ï¼Œå› ä¸ºå®ƒä»¬è®©ä»£ç å•å…ƒï¼ˆç±»æˆ–å‡½æ•°ï¼‰æ‰¿æ‹…çš„èŒè´£å¤ªå¤šã€‚
# @singledispath çš„ä¼˜ç‚¹æ˜¯æ”¯æŒæ¨¡å—åŒ–æ‰©å±•ï¼šå„ä¸ªæ¨¡å—å¯ä»¥ä¸ºå®ƒæ”¯æŒçš„å„ä¸ªç±»å‹æ³¨å†Œä¸€ä¸ªä¸“é—¨å‡½æ•°ã€‚
##æµ‹è¯•ç”¨ä¾‹
print(htmlize('Heimlich & Co.\n- a game'))
print(htmlize(['alpha', 66, {3, 2, 1}]))
print(htmlize(15))
print(htmlize(1))
print(htmlize(True))
print(htmlize(1.1))

##
